<VirtualHost *:4010>
    ServerName img.jgi.doe.gov
    UseCanonicalName Off
    ServerAdmin imgsupp@lists.jgi-psf.org
    ProxyRequests off
    RewriteEngine On

    Include ${APACHE_DEFAULT_DIR}/badbots.conf

	### IMG Specific ###
	<Proxy *>
  		Order deny,allow
  		Allow from all
	</Proxy>


	<Directory "${APACHE_CONTENT_DIR}/vhosts/*/htdocs/img_scratch">
		AllowOverride FileInfo Indexes Limit
		<Files ~ "\.(gif|jpe?g|png|bmp|tif?f|pdf)$">
			Order Allow,Deny
			Allow from all
		</Files>
		Order Deny,Allow
		Deny from All
	</Directory>

	<Directory "${APACHE_CONTENT_DIR}/vhosts/*/htdocs">
		AllowOverride FileInfo Indexes Limit
		Options Indexes FollowSymLinks MultiViews
		Order allow,deny
		allow from all
		Deny from env=DenyIP

		<IfModule mod_expires.c> 
 		ExpiresActive On 
 		ExpiresDefault "access plus 1 second" 
 		ExpiresByType image/gif "access plus 60 minutes" 
 		ExpiresByType image/jpeg "access plus 60 minutes" 
 		ExpiresByType image/png "access plus 60 minutes" 
 		ExpiresByType image/x-icon "access plus 60 minutes" 
 		ExpiresByType text/css "access plus 60 minutes" 
 		ExpiresByType text/javascript "access plus 60 minutes" 
 		ExpiresByType application/javascript "access plus 60 minutes" 
		</IfModule>
	</Directory>

	<Directory "${APACHE_CONTENT_DIR}/vhosts/*/cgi-bin">
		AllowOverride FileInfo Indexes Limit
		AddHandler cgi-script .cgi
		Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
		Order allow,deny
		allow from all
        Deny from env=blockAccess
	</Directory>

	ErrorLog ${APACHE_LOGS_DIR}/${HOSTNAME}-vhosts_error.log

	# Possible values include: debug, info, notice, warn, error, crit,
	# alert, emerg.
	LogLevel info

	CustomLog ${APACHE_LOGS_DIR}/${HOSTNAME}-vhosts_access.log vhost_combined

	VirtualDocumentRoot ${APACHE_CONTENT_DIR}/vhosts/%0/htdocs
	VirtualScriptAlias ${APACHE_CONTENT_DIR}/vhosts/%0/cgi-bin

    # Django WSGI settings - ken
    WSGIDaemonProcess imgprod processes=15 python-path=/webfs/projectdirs/microbial/img/pythonLocal/imgdev:/webfs/projectdirs/microbial/img/pythonLocal:/webfs/projectdirs/microbial/img/pythonLocal/lib/python2.7/site-packages:/webfs/projectdirs/microbial/img/pythonLocal/lib/python2.7
    WSGIProcessGroup imgprod
    WSGIScriptAlias /next /webfs/projectdirs/microbial/img/pythonLocal/imgdev/imgdev/wsgi.py
      
    <Directory /webfs/projectdirs/microbial/img/pythonLocal/imgdev>
        <Files wsgi.py>
            Order allow,deny
            Allow from all        
        </Files>
    </Directory>

</VirtualHost>

<VirtualHost *:4010>
    ServerName img-dev.jgi.doe.gov
    UseCanonicalName Off
    ServerAdmin imgsupp@lists.jgi-psf.org
    ProxyRequests off
    RewriteEngine On

    Include ${APACHE_DEFAULT_DIR}/badbots.conf

    ### IMG Specific ###
    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>


    <Directory "${APACHE_CONTENT_DIR}/vhosts/*/htdocs/img_scratch">
        AllowOverride FileInfo Indexes Limit
        <Files ~ "\.(gif|jpe?g|png|bmp|tif?f|pdf)$">
            Order Allow,Deny
            Allow from all
        </Files>
        Order Deny,Allow
        Deny from All
    </Directory>

    <Directory "${APACHE_CONTENT_DIR}/vhosts/*/htdocs">
        AllowOverride FileInfo Indexes Limit
        Options Indexes FollowSymLinks MultiViews
        Order allow,deny
        allow from all
        Deny from env=DenyIP

        <IfModule mod_expires.c> 
        ExpiresActive On 
        ExpiresDefault "access plus 1 second" 
        ExpiresByType image/gif "access plus 60 minutes" 
        ExpiresByType image/jpeg "access plus 60 minutes" 
        ExpiresByType image/png "access plus 60 minutes" 
        ExpiresByType image/x-icon "access plus 60 minutes" 
        ExpiresByType text/css "access plus 60 minutes" 
        ExpiresByType text/javascript "access plus 60 minutes" 
        ExpiresByType application/javascript "access plus 60 minutes" 
        </IfModule>
    </Directory>

    <Directory "${APACHE_CONTENT_DIR}/vhosts/*/cgi-bin">
        AllowOverride FileInfo Indexes Limit
        AddHandler cgi-script .cgi
        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
        Order allow,deny
        allow from all
        Deny from env=blockAccess
    </Directory>

    ErrorLog ${APACHE_LOGS_DIR}/${HOSTNAME}-vhosts_error_dev.log

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel info

    CustomLog ${APACHE_LOGS_DIR}/${HOSTNAME}-vhosts_access_dev.log vhost_combined

    VirtualDocumentRoot ${APACHE_CONTENT_DIR}/vhosts/%0/htdocs
    VirtualScriptAlias ${APACHE_CONTENT_DIR}/vhosts/%0/cgi-bin

    # Django WSGI settings - ken
#wwwimg@gpweb36 bin]$ /usr/sbin/httpd -V
#Server version: Apache/2.2.15 (Unix)
#Server built:   Jul 18 2016 15:12:33
#Server's Module Magic Number: 20051115:25
#Server loaded:  APR 1.3.9, APR-Util 1.3.9
#Compiled using: APR 1.3.9, APR-Util 1.3.9
#Architecture:   64-bit
#Server MPM:     Prefork
#  threaded:     no
#    forked:     yes (variable process count)
#
# from the above output cannot use the "threads=xx" flag for WSGIDaemonProcess
#
#    
    WSGIDaemonProcess imgweb processes=15 python-path=/webfs/projectdirs/microbial/img/pythonLocal/imgdev:/webfs/projectdirs/microbial/img/pythonLocal:/webfs/projectdirs/microbial/img/pythonLocal/lib/python2.7/site-packages:/webfs/projectdirs/microbial/img/pythonLocal/lib/python2.7
    WSGIProcessGroup imgweb
    WSGIScriptAlias /ken2 /webfs/projectdirs/microbial/img/pythonLocal/imgdev/imgdev/wsgi.py
      
    <Directory /webfs/projectdirs/microbial/img/pythonLocal/imgdev>
        <Files wsgi.py>
            Order allow,deny
            Allow from all        
        </Files>
    </Directory>

</VirtualHost>

